{{#if pagination}}
<div class="mt-8 px-4 py-4 bg-white border rounded-xl shadow-sm">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">

        <!-- INFO + LIMIT SELECTOR -->
        <div class="flex flex-col sm:flex-row sm:items-center gap-4">
            <!-- Info de registros -->
            <div class="text-sm text-gray-600">
                Mostrando
                <b>
                    {{add (multiply (subtract pagination.page 1) pagination.limit) 1}}
                    –
                    {{add (multiply (subtract pagination.page 1) pagination.limit) testigos.length}}
                </b>
                de
                <b>{{pagination.totalRecords}}</b>
                ejecuciones
            </div>

            <!-- Selector de límite -->
            <div class="flex items-center gap-2">
                <label for="limitSelect" class="text-sm text-gray-500">Mostrar:</label>
                <select id="limitSelect" 
                    class="px-3 py-1.5 text-sm border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 focus:outline-none cursor-pointer">
                    <option value="10" {{#if (eq pagination.limit 10)}}selected{{/if}}>10</option>
                    <option value="25" {{#if (eq pagination.limit 25)}}selected{{/if}}>25</option>
                    <option value="50" {{#if (eq pagination.limit 50)}}selected{{/if}}>50</option>
                    <option value="100" {{#if (eq pagination.limit 100)}}selected{{/if}}>100</option>
                </select>
                <span class="text-sm text-gray-500">por página</span>
            </div>
        </div>

        <!-- CONTROLES DE NAVEGACIÓN -->
        <div class="flex flex-wrap items-center gap-1">

            {{#if pagination.hasPrev}}
            <a href="#" data-page="1"
                class="pagination-link px-3 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-sm font-semibold transition">
                « Primera
            </a>
            {{else}}
            <span class="px-3 py-2 rounded-lg bg-gray-100 text-gray-400 text-sm">
                « Primera
            </span>
            {{/if}}

            {{#if pagination.hasPrev}}
            <a href="#" data-page="{{pagination.prevPage}}"
                class="pagination-link px-3 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-sm font-semibold transition">
                ‹ Anterior
            </a>
            {{else}}
            <span class="px-3 py-2 rounded-lg bg-gray-100 text-gray-400 text-sm">
                ‹ Anterior
            </span>
            {{/if}}

            <span class="px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-bold">
                {{pagination.page}} / {{pagination.totalPages}}
            </span>

            {{#if pagination.hasNext}}
            <a href="#" data-page="{{pagination.nextPage}}"
                class="pagination-link px-3 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-sm font-semibold transition">
                Siguiente ›
            </a>
            {{else}}
            <span class="px-3 py-2 rounded-lg bg-gray-100 text-gray-400 text-sm">
                Siguiente ›
            </span>
            {{/if}}

            {{#if pagination.hasNext}}
            <a href="#" data-page="{{pagination.totalPages}}"
                class="pagination-link px-3 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-sm font-semibold transition">
                Última »
            </a>
            {{else}}
            <span class="px-3 py-2 rounded-lg bg-gray-100 text-gray-400 text-sm">
                Última »
            </span>
            {{/if}}

        </div>
    </div>
</div>

<script>
    (() => {
        // Función para obtener los parámetros actuales y cambiar solo page/limit
        const buildUrl = (page, limit) => {
            const params = new URLSearchParams(window.location.search);
            params.set('page', page);
            if (limit) params.set('limit', limit);
            return `/refresh_cron?${params.toString()}`;
        };

        // Links de paginación
        document.querySelectorAll('.pagination-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.dataset.page;
                window.location.href = buildUrl(page);
            });
        });

        // Selector de límite
        document.getElementById('limitSelect')?.addEventListener('change', function() {
            window.location.href = buildUrl(1, this.value);
        });
    })();
</script>
{{/if}}
