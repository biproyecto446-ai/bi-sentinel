<h1 class="text-3xl font-bold mb-6 text-gray-800">{{titulo}}</h1>

{{#if error}}
<p class="text-red-600 text-lg font-semibold">{{error}}</p>
{{else}}

<a href="/refresh_cron"
    class="inline-block mb-6 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg">
    ← Regresar
</a>

<div class="bg-white shadow-md rounded-xl p-6 mb-6 border border-gray-200">
    <p><b>Status:</b>
        {{#if (eq json.status "SUCCESS")}}
        <span class="text-green-600 font-bold">{{json.status}}</span>
        {{else}}
        <span class="text-red-600 font-bold">{{json.status}}</span>
        {{/if}}
    </p>

    <p><b>Mensaje:</b> {{json.message}}</p>
    <p><b>Total vistas:</b> {{json.total_views}}</p>
    <p><b>Tiempo total:</b> {{formatDuration json.total_time_seconds}} s</p>
</div>

<h2 class="text-2xl font-semibold mb-4 text-gray-800">Detalle de vistas refrescadas</h2>

<div class="overflow-hidden shadow-lg rounded-xl border border-gray-200">
    <table class="min-w-full bg-white">
        <thead class="bg-gray-50 border-b">
            <tr class="text-gray-600 uppercase text-xs tracking-wide">
                <th class="px-4 py-3 text-left">Vista</th>
                <th class="px-4 py-3 text-left">Filas</th>
                <th class="px-4 py-3 text-left">Duración (s)</th>
                <th class="px-4 py-3 text-left">Estado</th>
                <th class="px-4 py-3 text-left">Error</th>
            </tr>
        </thead>

        <tbody class="divide-y divide-gray-200">
            {{#each json.details}}
            <tr class="hover:bg-gray-50 transition">
                <td class="px-4 py-3">{{this.view}}</td>
                <td class="px-4 py-3">{{this.rows}}</td>
                <td class="px-4 py-3">{{formatDuration this.duration_seconds}}</td>

                <td class="px-4 py-3">
                    {{#if (eq this.status "OK")}}
                    <span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">
                        ✔ OK
                    </span>
                    {{else}}
                    <span class="px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold">
                        ✖ {{this.status}}
                    </span>
                    {{/if}}
                </td>

                <td class="px-4 py-3 text-red-600 text-xs">{{this.error}}</td>
            </tr>
            {{/each}}
        </tbody>
    </table>
</div>

{{/if}}